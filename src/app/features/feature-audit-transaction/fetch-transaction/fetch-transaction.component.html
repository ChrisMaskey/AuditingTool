<div class="flex flex-col gap-5 w-full h-full">
  <!-- Dropdown Placeholder with Reset Button -->
  <div class="transaction-dropdown-placeholder">
    <!-- Dropdown placeholder -->

    <div
      class="flex items-center justify-between w-full"
      (click)="toggleDropdown()"
    >
      <h5 class="text-sm font-medium leading-[1.3125rem]">
        Search your transaction here
      </h5>
      <!-- Filter Icon -->
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="18"
        height="18"
        viewBox="0 0 18 19"
        fill="none"
      >
        <path
          d="M14.25 3H3.75C2.6895 3 2.15925 3 1.83 3.309C1.5 3.618 1.5 4.116 1.5 5.11125V5.62875C1.5 6.4065 1.5 6.79575 1.695 7.11825C1.89 7.44075 2.24475 7.64175 2.9565 8.04225L5.14125 9.27225C5.61825 9.54075 5.8575 9.675 6.0285 9.8235C6.384 10.1317 6.603 10.4948 6.702 10.941C6.75 11.154 6.75 11.4045 6.75 11.9048V13.9072C6.75 14.589 6.75 14.9302 6.939 15.1957C7.128 15.462 7.464 15.5933 8.1345 15.8558C9.54375 16.4063 10.248 16.6815 10.749 16.368C11.25 16.0552 11.25 15.339 11.25 13.9065V11.904C11.25 11.4045 11.25 11.154 11.298 10.9402C11.3922 10.5031 11.6295 10.1099 11.9723 9.82275C12.1425 9.675 12.3818 9.54075 12.8588 9.2715L15.0435 8.0415C15.7545 7.64175 16.1107 7.4415 16.305 7.119C16.5 6.7965 16.5 6.4065 16.5 5.628V5.1105C16.5 4.116 16.5 3.618 16.17 3.309C15.8415 3 15.3112 3 14.25 3Z"
          stroke="#4D4B4B"
          stroke-width="1.5"
        />
      </svg>
    </div>

    <!-- Reset Icon -->
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="16"
      height="16"
      viewBox="0 0 16 17"
      fill="none"
      (click)="resetForm()"
    >
      <g clip-path="url(#clip0_235_5363)">
        <path
          d="M15.0912 3.34464L14.0841 4.13214C12.7109 2.37679 10.5751 1.25 8.17693 1.25C4.03586 1.25 0.684074 4.59821 0.678717 8.74107C0.67336 12.8875 4.03229 16.25 8.17693 16.25C11.4144 16.25 14.1734 14.1964 15.2234 11.3196C15.2501 11.2446 15.2109 11.1607 15.1359 11.1357L14.1234 10.7875C14.0881 10.7754 14.0494 10.7776 14.0157 10.7936C13.982 10.8096 13.9559 10.8382 13.943 10.8732C13.9109 10.9625 13.8751 11.0518 13.8376 11.1393C13.5287 11.8714 13.0859 12.5286 12.5216 13.0929C11.9618 13.6536 11.2991 14.1011 10.5698 14.4107C9.81443 14.7304 9.00907 14.8929 8.1805 14.8929C7.35015 14.8929 6.54657 14.7304 5.79122 14.4107C5.06117 14.1024 4.39822 13.6548 3.83943 13.0929C3.27818 12.5332 2.83119 11.8697 2.52336 11.1393C2.20372 10.3821 2.04122 9.57857 2.04122 8.74822C2.04122 7.91786 2.20372 7.11429 2.52336 6.35714C2.83229 5.625 3.27515 4.96786 3.83943 4.40357C4.40372 3.83929 5.06086 3.39643 5.79122 3.08571C6.54657 2.76607 7.35193 2.60357 8.1805 2.60357C9.01086 2.60357 9.81443 2.76607 10.5698 3.08571C11.2998 3.39401 11.9628 3.84164 12.5216 4.40357C12.6984 4.58036 12.8644 4.76786 13.018 4.96429L11.943 5.80357C11.9217 5.82003 11.9055 5.84215 11.8963 5.8674C11.887 5.89265 11.8851 5.91999 11.8907 5.9463C11.8963 5.9726 11.9092 5.99679 11.9279 6.01608C11.9467 6.03537 11.9704 6.04899 11.9966 6.05536L15.1323 6.82322C15.2216 6.84464 15.3091 6.77679 15.3091 6.68572L15.3234 3.45536C15.3216 3.3375 15.1841 3.27143 15.0912 3.34464Z"
          fill="black"
          fill-opacity="0.85"
        />
      </g>
      <defs>
        <clipPath id="clip0_235_5363">
          <rect
            width="16"
            height="16"
            fill="white"
            transform="translate(0 0.75)"
          />
        </clipPath>
      </defs>
    </svg>
  </div>

  <!-- Transaction Table -->
  <ng-container
    *ngIf="fetchTransaction && (transactions$ | async) as transactions"
  >
    <p-table
      [value]="transactions"
      [paginator]="true"
      [rows]="10"
      [showCurrentPageReport]="true"
    >
      <ng-template pTemplate="header">
        <tr class="font-sans text-sm font-bold text-[#343A40]">
          <th>Date</th>
          <th>Transaction Type</th>
          <th>Trade Type</th>
          <th>Employee</th>
          <th>Name</th>
          <th>COA</th>
          <th>Transaction Mode</th>
          <th>Cheque Number</th>
          <th>Posted Date</th>
          <th>Amount</th>
          <th>Action</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-transaction>
        <tr class="text-sm text-[#495057] font-sans">
          <td>{{ transaction.date }}</td>
          <td>
            <p-tag
              [value]="transaction.transactionType.toUpperCase()"
              [severity]="getTransactionSeverity(transaction.transactionType)"
            ></p-tag>
          </td>
          <td>{{ transaction.tradeType }}</td>
          <td>
            <p-tag
              [value]="transaction.isEmployee ? 'YES' : 'NO'"
              [severity]="getEmployeeSeverity(transaction.isEmployee)"
            ></p-tag>
          </td>
          <td>{{ transaction.name }}</td>
          <td>{{ transaction.coa }}</td>
          <td>
            <p-tag
              [value]="transaction.transactionMode.toUpperCase()"
              [severity]="getModeSeverity(transaction.transactionMode)"
            ></p-tag>
          </td>
          <td>{{ transaction.chequeNumber }}</td>
          <td>{{ transaction.postedDate }}</td>
          <td>${{ formatAmount(transaction.amount) }}</td>
          <td>
            <div class="flex items-center justify-center gap-[0.375rem]">
              <p-tag severity="success">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="11"
                  height="11"
                  viewBox="0 0 11 11"
                  fill="none"
                >
                  <g clip-path="url(#clip0_905_4037)">
                    <path
                      d="M1.97038 10.75C1.51455 10.75 1.08271 10.5701 0.752834 10.2462C0.0810864 9.57444 0.0810864 8.48885 0.752834 7.8171L4.0576 4.51234C3.75771 3.34878 4.08159 2.09525 4.93327 1.24357C5.79095 0.385887 7.05047 0.0500132 8.22003 0.367894C8.37598 0.409878 8.49593 0.529833 8.53792 0.685775C8.5799 0.841716 8.53791 1.00366 8.42396 1.11761L6.95451 2.58706L7.26639 3.73263L8.41196 4.04452L9.88141 2.57507C9.99537 2.46111 10.1633 2.41912 10.3132 2.46111C10.4692 2.50309 10.5891 2.62305 10.6311 2.77899C10.949 3.94855 10.6191 5.20808 9.75546 6.06576C8.90378 6.91744 7.65025 7.24132 6.48668 6.94143L3.18192 10.2462C2.85805 10.5701 2.42621 10.75 1.97038 10.75ZM7.10445 1.16559C6.52867 1.21358 5.98287 1.46548 5.56303 1.88532C4.87929 2.56907 4.65737 3.57069 4.98725 4.49435C5.04722 4.65629 5.00524 4.84222 4.87929 4.96217L1.3826 8.45886C1.06472 8.77674 1.06472 9.29854 1.3826 9.61643C1.53854 9.77237 1.74246 9.85634 1.96438 9.85634C2.1803 9.85634 2.39022 9.77237 2.54016 9.61643L6.03685 6.11974C6.16281 5.99378 6.34274 5.9578 6.50468 6.01178C7.42833 6.33566 8.42996 6.11974 9.1137 5.43599C9.53354 5.01615 9.77945 4.47036 9.83343 3.89457L8.8558 4.8722C8.74184 4.98616 8.5739 5.02815 8.41796 4.98616L6.77458 4.53633C6.61863 4.49435 6.49868 4.37439 6.4567 4.21845L6.00686 2.57507C5.96488 2.41912 6.00686 2.25119 6.12082 2.13723L7.09845 1.1596L7.10445 1.16559Z"
                      fill="white"
                    />
                  </g>
                  <defs>
                    <clipPath id="clip0_905_4037">
                      <rect
                        width="10.5"
                        height="10.5"
                        fill="white"
                        transform="translate(0.25 0.25)"
                      />
                    </clipPath>
                  </defs>
                </svg>
              </p-tag>
              <p-tag severity="danger">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="11"
                  height="11"
                  viewBox="0 0 11 11"
                  fill="none"
                >
                  <g clip-path="url(#clip0_905_3825)">
                    <path
                      fill-rule="evenodd"
                      clip-rule="evenodd"
                      d="M2.83602 10.7466H8.16402C8.35416 10.7596 8.545 10.7348 8.72546 10.6735C8.90592 10.6122 9.07241 10.5158 9.21529 10.3897C9.35817 10.2636 9.47459 10.1105 9.5578 9.93909C9.641 9.7677 9.68934 9.58152 9.70002 9.39133V3.5203H10.3C10.4193 3.5203 10.5338 3.47292 10.6182 3.38857C10.7026 3.30422 10.75 3.18982 10.75 3.07053C10.75 2.95124 10.7026 2.83684 10.6182 2.75249C10.5338 2.66814 10.4193 2.62076 10.3 2.62076H9.29029C9.26522 2.61678 9.23972 2.61474 9.21402 2.61474C9.18831 2.61474 9.16282 2.61678 9.13775 2.62076H8.67137C8.68161 2.5817 8.68656 2.54135 8.68602 2.5008V1.60725C8.6628 1.22697 8.49029 0.871229 8.20602 0.617418C7.92174 0.363606 7.54869 0.232253 7.16802 0.251931H3.83202C3.45438 0.23711 3.08595 0.370651 2.80559 0.623963C2.52524 0.877275 2.35525 1.23022 2.33202 1.60725V2.5008C2.33202 2.5417 2.33759 2.58202 2.34832 2.62076H0.7C0.640905 2.62076 0.582389 2.63239 0.527792 2.655C0.473196 2.6776 0.423588 2.71073 0.381802 2.75249C0.340016 2.79426 0.306869 2.84384 0.284254 2.89841C0.26164 2.95298 0.25 3.01147 0.25 3.07053C0.25 3.1296 0.26164 3.18808 0.284254 3.24265C0.306869 3.29722 0.340016 3.3468 0.381802 3.38857C0.423588 3.43034 0.473196 3.46346 0.527792 3.48607C0.582389 3.50867 0.640905 3.5203 0.7 3.5203H1.30002V9.39133C1.31069 9.58152 1.35903 9.7677 1.44224 9.93909C1.52545 10.1105 1.64187 10.2636 1.78474 10.3897C1.92762 10.5158 2.09412 10.6122 2.27458 10.6735C2.45504 10.7348 2.64587 10.7596 2.83602 10.7466ZM2.20002 3.5203H8.72802V9.39133C8.72802 9.6372 8.46402 9.8471 8.12802 9.8471H2.80002C2.48202 9.8471 2.20002 9.6372 2.20002 9.39133V3.5203ZM3.21572 2.62076C3.22645 2.58202 3.23202 2.5417 3.23202 2.5008V1.60725C3.23202 1.36137 3.50202 1.15148 3.83202 1.15148H7.18602C7.49802 1.15148 7.78602 1.36137 7.78602 1.60725V2.5008C7.78547 2.54136 7.79048 2.58172 7.80086 2.62076H3.21572ZM4.43178 8.49779C4.31298 8.49623 4.19948 8.44835 4.11546 8.36433C4.03145 8.28032 3.98356 8.16682 3.98201 8.04801V5.33138C3.98201 5.21209 4.0294 5.09769 4.11375 5.01334C4.19809 4.92899 4.3125 4.88161 4.43178 4.88161C4.55107 4.88161 4.66547 4.92899 4.74982 5.01334C4.83417 5.09769 4.88156 5.21209 4.88156 5.33138V8.04202C4.88235 8.10158 4.8713 8.16072 4.84906 8.21598C4.82681 8.27124 4.7938 8.32153 4.75196 8.36394C4.71011 8.40634 4.66026 8.44001 4.6053 8.46298C4.55034 8.48596 4.49136 8.49779 4.43178 8.49779ZM6.24976 8.36605C6.33411 8.4504 6.44851 8.49779 6.5678 8.49779C6.68764 8.49621 6.80203 8.4475 6.88621 8.36219C6.97039 8.27689 7.01758 8.16186 7.01757 8.04202V5.33138C7.01757 5.21209 6.97019 5.09769 6.88584 5.01334C6.80149 4.92899 6.68709 4.88161 6.5678 4.88161C6.44851 4.88161 6.33411 4.92899 6.24976 5.01334C6.16541 5.09769 6.11803 5.21209 6.11803 5.33138V8.04801C6.11803 8.1673 6.16541 8.2817 6.24976 8.36605Z"
                      fill="white"
                    />
                  </g>
                  <defs>
                    <clipPath id="clip0_905_3825">
                      <rect
                        width="10.5"
                        height="10.5"
                        fill="white"
                        transform="translate(0.25 0.25)"
                      />
                    </clipPath>
                  </defs>
                </svg>
              </p-tag>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </ng-container>

  <!-- Content if no transaction found -->
  <div
    *ngIf="fetchTransaction === false || fetchTransaction === null"
    class="flex flex-col items-center justify-center h-full gap-2"
  >
    <!-- Empty Dropdown Container -->
    <ng-container *ngIf="fetchTransaction === false">
      <div class="w-[6.6rem] h-[6.2rem]">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="106"
          height="100"
          viewBox="0 0 106 100"
          fill="none"
        >
          <path
            d="M45.1033 99.9921C69.737 99.9921 89.7066 96.2607 89.7066 91.6579C89.7066 87.055 69.737 83.3237 45.1033 83.3237C20.4696 83.3237 0.5 87.055 0.5 91.6579C0.5 96.2607 20.4696 99.9921 45.1033 99.9921Z"
            fill="#F5F5F7"
            fill-opacity="0.8"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M80.7854 67.1737L65.0452 47.8019C64.29 46.8901 63.186 46.3381 62.0235 46.3381H28.1814C27.0196 46.3381 25.9156 46.8901 25.1604 47.8019L9.4209 67.1737V77.2941H80.786V67.1737H80.7854Z"
            fill="#AEB8C2"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M22.7566 21.3355H67.4493C68.1473 21.3355 68.8166 21.6128 69.3102 22.1063C69.8037 22.5998 70.0809 23.2692 70.0809 23.9671V85.3776C70.0809 86.0755 69.8037 86.7449 69.3102 87.2384C68.8166 87.7319 68.1473 88.0092 67.4493 88.0092H22.7566C22.0586 88.0092 21.3893 87.7319 20.8958 87.2384C20.4023 86.7449 20.125 86.0755 20.125 85.3776V23.9671C20.125 23.2692 20.4023 22.5998 20.8958 22.1063C21.3893 21.6128 22.0586 21.3355 22.7566 21.3355V21.3355Z"
            fill="#F5F5F7"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M28.5772 27.8835H61.6278C61.9768 27.8835 62.3115 28.0222 62.5582 28.2689C62.805 28.5157 62.9436 28.8504 62.9436 29.1993V45.6184C62.9436 45.9674 62.805 46.3021 62.5582 46.5488C62.3115 46.7956 61.9768 46.9342 61.6278 46.9342H28.5772C28.2282 46.9342 27.8935 46.7956 27.6468 46.5488C27.4 46.3021 27.2614 45.9674 27.2614 45.6184V29.1993C27.2614 28.8504 27.4 28.5157 27.6468 28.2689C27.8935 28.0222 28.2282 27.8835 28.5772 27.8835ZM28.7495 54.077H61.4555C61.8501 54.077 62.2287 54.2338 62.5077 54.5128C62.7868 54.7919 62.9436 55.1704 62.9436 55.5651C62.9436 55.9598 62.7868 56.3383 62.5077 56.6174C62.2287 56.8965 61.8501 57.0533 61.4555 57.0533H28.7495C28.3548 57.0533 27.9763 56.8965 27.6972 56.6174C27.4182 56.3383 27.2614 55.9598 27.2614 55.5651C27.2614 55.1704 27.4182 54.7919 27.6972 54.5128C27.9763 54.2338 28.3548 54.077 28.7495 54.077ZM28.7495 61.8158H61.4555C61.8502 61.8158 62.2288 61.9726 62.508 62.2518C62.7871 62.5309 62.9439 62.9095 62.9439 63.3043C62.9439 63.699 62.7871 64.0776 62.508 64.3568C62.2288 64.6359 61.8502 64.7928 61.4555 64.7928H28.7495C28.3548 64.7928 27.9762 64.6359 27.697 64.3568C27.4179 64.0776 27.261 63.699 27.261 63.3043C27.261 62.9095 27.4179 62.5309 27.697 62.2518C27.9762 61.9726 28.3548 61.8158 28.7495 61.8158ZM80.6397 90.4355C80.1298 92.4559 78.339 93.9618 76.2087 93.9618H13.9962C11.866 93.9618 10.0752 92.4553 9.56597 90.4355C9.46886 90.0505 9.4198 89.6549 9.41992 89.2579V67.1743H26.7344C28.6469 67.1743 30.1883 68.7849 30.1883 70.7401V70.7664C30.1883 72.721 31.7476 74.2993 33.6601 74.2993H56.5449C58.4574 74.2993 60.0166 72.7066 60.0166 70.7513V70.7434C60.0166 68.7881 61.5581 67.1737 63.4706 67.1737H80.7851V89.2585C80.7851 89.6645 80.7344 90.0585 80.6397 90.4355Z"
            fill="#DCE0E6"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M82.8162 22.4026L78.3227 24.1461C78.2073 24.1909 78.0815 24.2023 77.9599 24.1789C77.8383 24.1555 77.7258 24.0982 77.6352 24.0137C77.5447 23.9292 77.4799 23.8208 77.4483 23.7011C77.4166 23.5813 77.4194 23.4551 77.4563 23.3368L78.7306 19.2533C77.0273 17.3164 76.0273 14.9546 76.0273 12.4059C76.0273 5.83026 82.6839 0.5 90.8958 0.5C99.1056 0.5 105.763 5.83026 105.763 12.4059C105.763 18.9816 99.1063 24.3118 90.8951 24.3118C87.9162 24.3118 85.1425 23.6105 82.8162 22.4026Z"
            fill="#DCE0E6"
          />
          <path
            d="M96.7523 14.5559C97.7874 14.5559 98.6266 13.7268 98.6266 12.704C98.6266 11.6811 97.7874 10.852 96.7523 10.852C95.7171 10.852 94.8779 11.6811 94.8779 12.704C94.8779 13.7268 95.7171 14.5559 96.7523 14.5559Z"
            fill="white"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M86.9127 14.3243H83.1641L85.0706 11.0836L86.9127 14.3243ZM89.2555 11.0836H92.5351V14.3243H89.2555V11.0836Z"
            fill="white"
          />
        </svg>
      </div>

      <!-- Heading -->
      <h3 class="text-center text-[1rem] font-semibold leading-[1.375rem]">
        Please use the search filter to find transaction
      </h3>

      <!-- Sub Heading -->
      <h4
        class="text-center text-sm leading-[1.375rem] text-black opacity-[45%]"
      >
        The cloud server configuration procedure will be completed in 1-5
        <br />minutes, so please be patient.
      </h4>
    </ng-container>

    <ng-container *ngIf="fetchTransaction === null">
      <div class="flex flex-col items-center justify-center gap-6">
        <img
          src="/assets/no-data-found.svg"
          alt=""
          class="w-[15.843rem] h-[15.33rem]"
        />
        <h1 class="text-2xl text-center text-[#000000D9]">No data found</h1>
      </div>
    </ng-container>
  </div>
</div>

<!-- @TODO BUG: DROPDOWN DISAPPEARS AFTER SEARCH -->
<!-- Transaction Dropdown -->
<ng-container *ngIf="isOpen">
  <div
    class="absolute top-60 flex items-center justify-center w-[28.5rem] h-[20.5rem] px-[1.56rem] pt-9 pb-[3.25rem] bg-[#F8F7F7] rounded-md border border-[#CED4DA] z-50"
  >
    <div class="flex flex-col items-start gap-6 w-full">
      <!-- REACTIVE FORM -->
      <form
        [formGroup]="transactionFilterForm"
        class="flex flex-col gap-4 w-full"
      >
        <p-dropdown
          *ngIf="clients$ | async as clients"
          formControlName="clientId"
          [options]="clients"
          optionLabel="legalName"
          placeholder="Client Name*"
          [required]="true"
          [optionValue]="'id'"
        >
        </p-dropdown>
        <p-dropdown
          *ngIf="banks$ | async as banks"
          formControlName="bankName"
          [options]="banks"
          optionLabel="bankName"
          placeholder="Bank Name*"
          [required]="true"
          [optionValue]="'bankName'"
        ></p-dropdown>
        <p-dropdown
          *ngIf="accounts$ | async as accounts"
          formControlName="accountNumber"
          [options]="accounts"
          optionLabel="accountNumber"
          placeholder="Account Number*"
          [required]="true"
          [optionValue]="'accountNumber'"
        ></p-dropdown>
        <p-calendar
          formControlName="date"
          view="month"
          dateFormat="mm/yy"
          placeholder="Month-Year"
          [readonlyInput]="true"
          [showIcon]="true"
        ></p-calendar>
      </form>

      <button
        class="p-[0.625rem] rounded-[0.25rem] bg-[#3B82F6] w-full hover:bg-[#2563EB] active:bg-[#1D4ED8] duration-200"
        (click)="fetchTransactions()"
      >
        <span class="text-[0.75rem] font-medium leading-[1.125rem] text-white"
          >Search</span
        >
      </button>
    </div>
  </div>
</ng-container>
